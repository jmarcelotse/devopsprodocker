# Trabalhando com Vari√°veis de Ambiente em Cont√™ineres Docker
As vari√°veis de ambiente s√£o uma maneira eficiente de fornecer configura√ß√µes para cont√™ineres sem precisar alterar o c√≥digo ou a imagem base. Elas s√£o amplamente utilizadas para definir credenciais, configura√ß√µes de aplicativos, caminhos de diret√≥rios e outros par√¢metros importantes.

# 1. Definindo Vari√°veis de Ambiente no Docker
## 1.1 Usando a Flag -e no docker run
Voc√™ pode passar vari√°veis de ambiente diretamente ao iniciar um cont√™iner com a flag `-e`.

### Exemplo:

bash
```
docker run -d -e ENV_VAR=valor ubuntu env
```
- `ENV_VAR`: Nome da vari√°vel de ambiente.
- `valor`: Valor atribu√≠do √† vari√°vel.

### Sa√≠da do comando acima:

plaintext
```
ENV_VAR=valor
```
## 1.2 Usando um Arquivo .env
Para gerenciar m√∫ltiplas vari√°veis de ambiente, voc√™ pode usar um arquivo `.env`.

1. Crie o arquivo `.env`:

plaintext
```
DB_HOST=localhost
DB_USER=root
DB_PASS=senha123
```
2. Inicie o cont√™iner usando o arquivo `.env`:

bash
```
docker run --env-file .env ubuntu env
```
# 1.3 Definindo Vari√°veis no Dockerfile
Voc√™ pode definir vari√°veis diretamente no `Dockerfile` usando a instru√ß√£o `ENV`.

**Exemplo de** `Dockerfile`:

dockerfile
```
FROM ubuntu:latest
ENV ENV_VAR valor
CMD ["printenv"]
```
- Construa a imagem:

bash
```
docker build -t minha-imagem .
```
- Execute o cont√™iner:

bash
```
docker run minha-imagem
```
### Sa√≠da:

plaintext
```
ENV_VAR=valor
```
## 1.4 Sobrescrevendo Vari√°veis no Dockerfile
Voc√™ pode sobrescrever vari√°veis definidas no `Dockerfile` usando a flag `-e`.

### Exemplo:

bash
```
docker run -e ENV_VAR=novo_valor minha-imagem
```
### Sa√≠da:

plaintext
```
ENV_VAR=novo_valor
```
# 2. Utilizando Vari√°veis de Ambiente no Docker Compose
## 2.1 Definindo Vari√°veis no `docker-compose.yml`
Voc√™ pode definir vari√°veis de ambiente diretamente no arquivo `docker-compose.yml`.

Exemplo:

yaml
```
version: '3.8'
services:
  app:
    image: nginx
    environment:
      - ENV_VAR1=valor1
      - ENV_VAR2=valor2
```
## 2.2 Usando um Arquivo `.env` com Docker Compose
1. Crie o arquivo `.env`:

plaintext
```
PORT=8080
ENV_MODE=production
```
2. Configure o `docker-compose.yml` para usar essas vari√°veis:

yaml
```
version: '3.8'
services:
  app:
    image: nginx
    ports:
      - "${PORT}:80"
    environment:
      - MODE=${ENV_MODE}
```
3. Inicie os servi√ßos:

bash
```
docker-compose up -d
```
# 3. Listando e Inspecionando Vari√°veis de Ambiente
## 3.1 Listar Vari√°veis em um Cont√™iner em Execu√ß√£o
Para visualizar todas as vari√°veis de ambiente dentro de um cont√™iner:

bash
```
docker exec <container_id ou nome> printenv
```
## 3.2 Inspecionar Vari√°veis com docker inspect
Para verificar vari√°veis configuradas em um cont√™iner:

bash
```
docker inspect <container_id ou nome> | grep -i env
```
# 4. Exemplos Pr√°ticos
## 4.1 Usando Vari√°veis de Ambiente para Configurar um Banco de Dados
### Comando Simples
bash
```
docker run -d -e POSTGRES_USER=admin -e POSTGRES_PASSWORD=senha postgres
```
- `POSTGRES_USER`: Define o usu√°rio do banco de dados.
- `POSTGRES_PASSWORD`: Define a senha do banco de dados.

### Com Docker Compose
yaml
```
version: '3.8'
services:
  db:
    image: postgres
    environment:
      - POSTGRES_USER=admin
      - POSTGRES_PASSWORD=senha
```
## 4.2 Substituindo Vari√°veis em Tempo de Execu√ß√£o
Voc√™ pode definir vari√°veis no host e pass√°-las para o cont√™iner.

### Definir no Host:

bash
```
export API_KEY=meu-api-key
```
### Executar o Cont√™iner:

bash
```
docker run -e API_KEY ubuntu env
```
# 5. Pr√°ticas Recomendadas
1. **Evite Hardcoding**:
- Use arquivos `.env` ou vari√°veis de ambiente do host para evitar valores sens√≠veis diretamente no c√≥digo ou `docker-compose.yml`.

2. **Proteja Credenciais**:
- Nunca exponha informa√ß√µes sens√≠veis, como senhas, em arquivos compartilhados.
- Considere ferramentas como **Docker Secrets** para gerenciar credenciais em produ√ß√£o.

3. **Documente Vari√°veis**:
- Documente todas as vari√°veis necess√°rias para os cont√™ineres, facilitando o uso por outros desenvolvedores.

4. **Use `.env` Padr√£o para Ambientes**:
- Crie arquivos `.env` separados para diferentes ambientes (`.env.dev, .env.prod`).

# 6. Resolu√ß√£o de Problemas
## 6.1 Vari√°vel N√£o Encontrada
Certifique-se de que a vari√°vel foi passada corretamente:
1. Liste vari√°veis no cont√™iner:

bash
```
docker exec <container_id ou nome> printenv
```
2. Verifique o uso correto no `docker run` ou `docker-compose.yml`.

# 7. Conclus√£o
Trabalhar com vari√°veis de ambiente no Docker √© uma pr√°tica essencial para configurar e personalizar cont√™ineres de forma flex√≠vel e segura. Elas s√£o particularmente √∫teis em cen√°rios de desenvolvimento, teste e produ√ß√£o, oferecendo uma maneira eficiente de separar configura√ß√µes do c√≥digo.

Se precisar de ajuda para configurar vari√°veis em cen√°rios mais avan√ßados ou para gerenciar segredos de maneira segura, estou aqui para ajudar! üòä