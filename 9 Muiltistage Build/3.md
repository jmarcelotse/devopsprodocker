# Especificando um Target no Multistage Build
No Docker, voc√™ pode usar a flag `--target` para construir at√© um est√°gio espec√≠fico de um Multistage Build. Isso √© √∫til quando voc√™ deseja interromper o processo em um ponto intermedi√°rio, como no est√°gio de build ou testes, sem gerar a imagem final.

# 1. Como Funciona o --target
- A flag `--target` especifica o alias (nome) do est√°gio no Dockerfile onde o processo de build deve parar.
- Isso √© √∫til para:
   - Depurar um est√°gio intermedi√°rio.
   - Testar apenas o build sem gerar a imagem final.
   - Reduzir o tempo de desenvolvimento.

# 2. Exemplo de Dockerfile com Multistage Build
Vamos usar o seguinte **Dockerfile**:

dockerfile
```
# Etapa 1: Build
FROM node:16 AS build
WORKDIR /app
COPY package.json .
RUN npm install
COPY . .
RUN npm run build

# Etapa 2: Testes
FROM build AS test
WORKDIR /app
RUN npm run test

# Etapa 3: Produ√ß√£o
FROM node:16-alpine AS production
WORKDIR /app
COPY --from=build /app/dist /app/dist
COPY package.json .
RUN npm install --production
CMD ["node", "/app/dist/app.js"]
```
# 3. Especificando o Target no Build
## 3.1 Construir Apenas o Est√°gio de Build
Se voc√™ quiser construir apenas a etapa de build:

bash
```
docker build --target build -t multistage-app:build .
```
### O que acontece?
- O build √© interrompido ap√≥s o est√°gio `build`.
- Nenhuma camada adicional, como testes ou produ√ß√£o, ser√° executada.

## 3.2 Construir Apenas o Est√°gio de Testes
Para construir e executar at√© a etapa de testes:

bash
```
docker build --target test -t multistage-app:test .
```
### O que acontece?
- As etapas de build e teste ser√£o executadas.
- O processo para antes da cria√ß√£o da imagem final de produ√ß√£o.

## 3.3 Construir a Imagem Final
Para construir todas as etapas at√© a imagem final:

bash
```
docker build -t multistage-app:production .
```
### O que acontece?
- Todos os est√°gios s√£o executados.
- A imagem final de produ√ß√£o ser√° criada.

# 4. Benef√≠cios do Uso do --target
1. **Depura√ß√£o Facilitada**:
- Verifique cada est√°gio do build separadamente.
- Depure problemas sem executar todas as etapas.

2. **Acelera o Desenvolvimento**:
- Pule etapas desnecess√°rias (como testes) enquanto trabalha no est√°gio de build.

3. **Reduz Custo em Ambientes CI/CD**:
- Execute apenas os est√°gios necess√°rios para diferentes pipelines.

# 5. Comandos √öteis com o Target
## 5.1 Inspecionar a Imagem Criada
Use o comando `docker images` para verificar as imagens geradas:

bash
```
docker images multistage-app
```
## 5.2 Executar o Cont√™iner de um Est√°gio Intermedi√°rio
Se voc√™ quiser testar o cont√™iner de um est√°gio intermedi√°rio:

bash
```
docker run --rm multistage-app:build
```
# 6. Casos de Uso Comuns
## 6.1 Pipeline CI/CD
- **Pipeline de Build**:
   - Executa apenas at√© o est√°gio `build` para verificar se o projeto compila corretamente:

bash
```
docker build --target build -t multistage-app:build .
```

- **Pipeline de Testes**:
   - Constr√≥i at√© o est√°gio `test` para validar os testes unit√°rios:

bash
```
docker build --target test -t multistage-app:test .
```

- **Pipeline de Produ√ß√£o**:
   - Constr√≥i a imagem final para deploy:

bash
```
docker build -t multistage-app:production .
```
## 6.2 Desenvolvimento Local
- Teste apenas o est√°gio de build enquanto desenvolve:

bash
```
docker build --target build -t multistage-app:build .
```
- Teste altera√ß√µes no c√≥digo sem executar o est√°gio de produ√ß√£o.

# 7. Exemplo Completo na Pr√°tica
## Passos no Terminal
1. **Construir o Est√°gio de Build**:

bash
```
docker build --target build -t multistage-app:build .
```
2. **Construir o Est√°gio de Testes**:

bash
```
docker build --target test -t multistage-app:test .
```
3. **Construir a Imagem Final de Produ√ß√£o**:

bash
```
docker build -t multistage-app:production .
```
1. **Executar o Cont√™iner de Produ√ß√£o**:

bash
```
docker run -d -p 3000:3000 multistage-app:production
```
# 8. Conclus√£o
O `--target` no Multistage Build √© uma funcionalidade poderosa que permite construir e depurar etapas espec√≠ficas de um Dockerfile. Ele melhora a efici√™ncia do desenvolvimento e integra√ß√µes em pipelines CI/CD, economizando tempo e recursos.

## Resumo de Benef√≠cios:
- Construa apenas os est√°gios necess√°rios.
- Facilite a depura√ß√£o de problemas.
- Integre de forma eficiente com pipelines CI/CD.

Se precisar de ajuda para configurar um Multistage Build ou usar --target em um cen√°rio espec√≠fico, √© s√≥ chamar! üöÄüòä