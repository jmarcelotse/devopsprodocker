# WORKDIR no Dockerfile
A instru√ß√£o `WORKDIR` no **Dockerfile** define o diret√≥rio de trabalho padr√£o dentro do cont√™iner. Isso significa que todos os comandos subsequentes (`COPY`, `RUN`, `CMD`, etc.) ser√£o executados a partir desse diret√≥rio, a menos que outro diret√≥rio seja especificado.

# 1. Funcionamento do `WORKDIR`
## Sintaxe B√°sica

dockerfile
```
WORKDIR /caminho/do/diretorio
```
- Se o diret√≥rio especificado n√£o existir, ele ser√° **criado automaticamente**.
- Voc√™ pode definir m√∫ltiplas instru√ß√µes `WORKDIR` no Dockerfile; cada uma ser√° relativa √† anterior.

# 2. Exemplo Simples com `WORKDIR`
Imagine o seguinte **Dockerfile** para uma aplica√ß√£o Node.js:

dockerfile
```
# Usar uma imagem base
FROM node:16

# Definir o diret√≥rio de trabalho
WORKDIR /usr/src/app

# Copiar os arquivos para o diret√≥rio de trabalho
COPY package.json .
RUN npm install

# Copiar o restante do c√≥digo
COPY . .

# Expor a porta e definir o comando padr√£o
EXPOSE 3000
CMD ["node", "app.js"]
```

## Explica√ß√£o:
1. `WORKDIR /usr/src/app`:
- Define `/usr/src/app` como o diret√≥rio padr√£o.
- Todos os comandos subsequentes (`COPY`, `RUN`, etc.) acontecer√£o dentro deste diret√≥rio.

2. `COPY package.json .`:
- Copia `package.json` do **diret√≥rio atual do host** para `/usr/src/app` no cont√™iner.

3. `RUN npm install`:
- Executa `npm install` no diret√≥rio `/usr/src/app`.

4. `COPY . .`:
- Copia todo o c√≥digo do projeto do **diret√≥rio atual do host** para `/usr/src/app`.

# 3. M√∫ltiplos WORKDIRs
Voc√™ pode usar m√∫ltiplas instru√ß√µes `WORKDIR` no Dockerfile. Quando especificadas em sequ√™ncia, elas s√£o **relativas** √† √∫ltima.

## Exemplo:

dockerfile
```
FROM ubuntu

WORKDIR /app
WORKDIR src
WORKDIR components

RUN pwd
```

## Sa√≠da do `pwd`:

bash
```
/app/src/components
```
Neste caso:

- `/app` ‚Üí `/app/src` ‚Üí `/app/src/components` s√£o criados automaticamente e encadeados.

# 4. Quando N√£o Usar o `WORKDIR`
Se voc√™ **n√£o** definir um `WORKDIR`, o diret√≥rio padr√£o ser√° `/` (diret√≥rio raiz do sistema).

Exemplo:

dockerfile
```
FROM ubuntu
RUN pwd
```
Sa√≠da:

```
/
```
# 5. Vantagens do WORKDIR
1. **Organiza√ß√£o**:
- Mant√©m o diret√≥rio de trabalho organizado, facilitando a manuten√ß√£o do Dockerfile.

2. **Evita Comandos Relativos**:
- N√£o √© necess√°rio especificar caminhos completos em cada instru√ß√£o:

dockerfile
```
WORKDIR /app
COPY . .     # Copia para /app, pois WORKDIR foi definido
```

3. **Reprodutibilidade**:
- Torna o ambiente mais previs√≠vel e f√°cil de depurar.

4. **Portabilidade**:
- Mesmo que o diret√≥rio n√£o exista no sistema base, ele ser√° criado automaticamente.

# 6. WORKDIR vs. Diret√≥rios Criados no `RUN`
Voc√™ poderia usar `RUN mkdir -p /diretorio`, mas isso n√£o tem o mesmo efeito que o `WORKDIR`.

## Exemplo Sem `WORKDIR`:

dockerfile
```
RUN mkdir -p /app
COPY . /app
RUN cd /app && npm install
```
Aqui:
- Voc√™ precisa do comando `cd` para navegar at√© o diret√≥rio `/app`.
- O comando `cd` s√≥ √© aplicado durante o `RUN`, e cada `RUN` inicia um **novo shell**, ent√£o o diret√≥rio n√£o √© persistido.

## Exemplo com `WORKDIR` (Recomendado):

dockerfile
```
WORKDIR /app
COPY . .
RUN npm install
```
Aqui:
- O `WORKDIR` √© persistido em todas as instru√ß√µes subsequentes.
- N√£o h√° necessidade de usar `cd`, tornando o Dockerfile mais limpo e eficiente.

# 7. Compara√ß√£o com USER
O `WORKDIR` define **onde** os comandos s√£o executados, enquanto o `USER` define **quem** executa os comandos.

## Exemplo:

dockerfile
```
FROM ubuntu

WORKDIR /home
USER nobody

RUN whoami   # Executa como o usu√°rio "nobody" dentro do diret√≥rio /home
```
# 8. Testando o WORKDIR
## Passo 1: Criar um Dockerfile

dockerfile
```
FROM ubuntu
WORKDIR /app
RUN touch test.txt
RUN ls -la
```
## Passo 2: Construir a Imagem

bash
```
docker build -t workdir-test .
```

## Passo 3: Executar o Cont√™iner

bash
```
docker run -it workdir-test /bin/bash
```

## Passo 4: Verificar o Diret√≥rio de Trabalho

bash
```
pwd
ls -la
```

### Sa√≠da Esperada:

bash
```
/app
total 0
-rw-r--r-- 1 root root 0 test.txt
```
# 9. Conclus√£o
A instru√ß√£o `WORKDIR` √© uma pr√°tica recomendada no Dockerfile porque:

- Define um diret√≥rio de trabalho previs√≠vel e organizado.
- Elimina a necessidade de comandos `cd`.
- Permite executar comandos subsequentes de forma limpa e direta.
- Facilita a manuten√ß√£o e a legibilidade do Dockerfile.

empre use `WORKDIR` para organizar seus ambientes e evitar caminhos absolutos desnecess√°rios! üöÄ

Se tiver mais d√∫vidas ou precisar de um exemplo espec√≠fico, √© s√≥ perguntar! üòä