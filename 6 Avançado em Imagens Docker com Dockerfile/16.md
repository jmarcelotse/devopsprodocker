# Criando uma Imagem Docker para uma AplicaÃ§Ã£o com Dockerfile
Neste exemplo, criaremos uma imagem Docker para uma aplicaÃ§Ã£o **Node.js** simples com um **Dockerfile**. Vamos construir uma aplicaÃ§Ã£o que retorna "OlÃ¡, Docker!" e entender cada passo para criar a imagem.

# 1. Estrutura do Projeto
Organize os arquivos da seguinte forma:

bash
```
minha-aplicacao/
â”‚
â”œâ”€â”€ app.js                 # CÃ³digo da aplicaÃ§Ã£o Node.js
â”œâ”€â”€ package.json           # ConfiguraÃ§Ãµes e dependÃªncias da aplicaÃ§Ã£o
â””â”€â”€ Dockerfile             # Arquivo de configuraÃ§Ã£o para criar a imagem Docker
```
# 2. Criando os Arquivos
## 2.1 CÃ³digo da AplicaÃ§Ã£o - app.js
Crie um servidor bÃ¡sico com o Node.js:

javascript
```
const express = require('express');
const app = express();
const port = process.env.PORT || 3000;

app.get('/', (req, res) => {
    res.send('OlÃ¡, Docker!');
});

app.listen(port, () => {
    console.log(`Servidor rodando em http://localhost:${port}`);
});
```
## 2.2 ConfiguraÃ§Ãµes do Projeto - `package.json`
Adicione as dependÃªncias necessÃ¡rias para o projeto:

json
```
{
  "name": "minha-aplicacao",
  "version": "1.0.0",
  "description": "Exemplo de aplicaÃ§Ã£o Docker com Node.js",
  "main": "app.js",
  "scripts": {
    "start": "node app.js"
  },
  "dependencies": {
    "express": "^4.18.2"
  }
}
```
Instale as dependÃªncias executando no terminal, dentro do diretÃ³rio do projeto:

bash
```
npm install
```
## 2.3 Criando o Dockerfile
O **Dockerfile** contÃ©m as instruÃ§Ãµes para criar a imagem da aplicaÃ§Ã£o. Aqui estÃ¡ o exemplo completo:

dockerfile
```
# Etapa 1: Usar uma imagem base do Node.js
FROM node:16

# Etapa 2: Definir o diretÃ³rio de trabalho no contÃªiner
WORKDIR /usr/src/app

# Etapa 3: Copiar os arquivos de configuraÃ§Ã£o e instalar dependÃªncias
COPY package*.json ./
RUN npm install

# Etapa 4: Copiar o restante do cÃ³digo para o contÃªiner
COPY . .

# Etapa 5: Expor a porta da aplicaÃ§Ã£o
EXPOSE 3000

# Etapa 6: Definir o comando para iniciar a aplicaÃ§Ã£o
CMD ["npm", "start"]
```
# 3. Construindo a Imagem
1. Navegue atÃ© o diretÃ³rio do projeto:

bash
```
cd minha-aplicacao
```
2. Execute o comando para construir a imagem:

bash
```
docker build -t minha-aplicacao:1.0 .
```
- `-t minha-aplicacao:1.0`: Nomeia a imagem como `minha-aplicacao` e define a tag como `1.0`.
- `.`: O ponto indica o diretÃ³rio atual como contexto de build.

# 4. Executando a Imagem
Depois de criar a imagem, vocÃª pode executar um contÃªiner baseado nela.

1. **Iniciar o contÃªiner e mapear portas**:

bash
```
docker run -d -p 3000:3000 minha-aplicacao:1.0
```
- `-d`: Executa o contÃªiner em segundo plano.
- `-p 3000:3000`: Mapeia a porta 3000 do host para a porta 3000 do contÃªiner.

2. **Testar a aplicaÃ§Ã£o**: Acesse no navegador ou com um comando `curl`:

bash
```
curl http://localhost:3000
```
### SaÃ­da esperada:

css
```
OlÃ¡, Docker!
```
# 5. Gerenciando o ContÃªiner
## 5.1 Verificar ContÃªineres Ativos
bash
```
docker ps
```
## 5.2 Parar o ContÃªiner
bash
```
docker stop <CONTAINER_ID>
```
## 5.3 Remover o ContÃªiner
bash
```
docker rm <CONTAINER_ID>
```
# 6. Publicando a Imagem
VocÃª pode compartilhar sua imagem com outras pessoas ou sistemas usando um repositÃ³rio, como o Docker Hub.

## 6.1 Taggear a Imagem
bash
```
docker tag minha-aplicacao:1.0 meu-usuario/minha-aplicacao:1.0
```
## 6.2 Fazer Login no Docker Hub
bash
```
docker login
```
## 6.3 Enviar a Imagem para o Docker Hub
bash
```
docker push meu-usuario/minha-aplicacao:1.0
```
# 7. Melhorando o Dockerfile
## 7.1 Reduzindo o Tamanho da Imagem
Use uma imagem base mais leve, como `node:16-alpine`:

dockerfile
```
FROM node:16-alpine
```
## 7.2 Usando .dockerignore
Evite incluir arquivos desnecessÃ¡rios na imagem, criando um arquivo `.dockerignore`:

**Exemplo** `.dockerignore`:

bash
```
node_modules
*.log
.git
Dockerfile
```
# 8. Multistage Build para OtimizaÃ§Ã£o
Se a aplicaÃ§Ã£o exigir etapas de build (como em React ou Angular), use **Multistage Build** para criar imagens menores:

dockerfile
```
# Etapa 1: Build
FROM node:16 AS build
WORKDIR /usr/src/app
COPY package*.json ./
RUN npm install
COPY . .
RUN npm run build

# Etapa 2: ExecuÃ§Ã£o
FROM node:16-alpine
WORKDIR /app
COPY --from=build /usr/src/app/dist /app
EXPOSE 3000
CMD ["node", "app.js"]
```
# 9. ConclusÃ£o
VocÃª criou uma imagem Docker para uma aplicaÃ§Ã£o Node.js e aprendeu a:
- Estruturar o projeto.
- Escrever um Dockerfile.
- Construir e executar a imagem.
- Publicar e otimizar a imagem.

Essa abordagem pode ser adaptada para qualquer aplicaÃ§Ã£o. Se precisar de mais exemplos ou otimizaÃ§Ãµes, Ã© sÃ³ perguntar! ğŸš€ğŸ˜Š