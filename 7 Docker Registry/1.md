# Docker Registry
O **Docker Registry** √© um servi√ßo para armazenar, gerenciar e distribuir imagens Docker. Ele pode ser um servi√ßo p√∫blico, como o **Docker Hub**, ou privado, configurado em sua pr√≥pria infraestrutura.

# 1. O Que √© Docker Registry?
Um Docker Registry √© essencialmente um **reposit√≥rio** onde imagens Docker s√£o armazenadas e distribu√≠das. Ele suporta:

- **Push**: Enviar imagens para o registro.
- **Pull**: Baixar imagens do registro.
- **Gerenciamento**: Tags, vers√µes e permiss√µes das imagens.

Existem dois tipos principais de registries:

1. **Registries P√∫blicos**:
   - Exemplos: Docker Hub, GitHub Container Registry, Amazon Elastic Container Registry (ECR).
2. **Registries Privados**:
   - Configurados localmente ou em provedores de nuvem.

# 2. Principais Comandos Relacionados ao Docker Registry
## 2.1 Login
Autenticar-se em um registro:

bash
```
docker login <url-do-registro>
```
- **Exemplo com Docker Hub**:

bash
```
docker login
```
- **Exemplo com Registro Privado**:

bash
```
docker login registry.minhaempresa.com
```
## 2.2 Enviar Imagem para o Registro (Push)
bash
```
docker tag <nome-local> <url-do-registro>/<namespace>/<nome-imagem>:<tag>
docker push <url-do-registro>/<namespace>/<nome-imagem>:<tag>
```
## Exemplo:

bash
```
docker tag minha-imagem:1.0 meu-usuario/minha-imagem:1.0
docker push meu-usuario/minha-imagem:1.0
```
## 2.3 Baixar Imagem do Registro (Pull)
bash
```
docker pull <url-do-registro>/<namespace>/<nome-imagem>:<tag>
```
### Exemplo:

bash
```
docker pull nginx:latest
```
Se a URL do registro n√£o for especificada, o Docker usar√° o **Docker Hub** como padr√£o.

## 2.4 Listar Imagens no Docker Hub
N√£o h√° um comando direto no Docker CLI para listar todas as imagens no Docker Hub, mas voc√™ pode acessar Docker Hub para ver as imagens associadas √† sua conta.

## 2.5 Remover Imagens do Registro
Atualmente, n√£o √© poss√≠vel remover imagens diretamente com o CLI. Isso deve ser feito usando APIs do registro ou interfaces espec√≠ficas (como o Docker Hub).

# 3. Configurando um Docker Registry Privado
Se voc√™ precisa de um registro privado, pode usar a imagem oficial `registry` do Docker.

## 3.1 Subir o Registro Local
Execute o seguinte comando para iniciar um registro local:

bash
```
docker run -d -p 5000:5000 --name registry registry:2
```
- O registro estar√° acess√≠vel em localhost:5000.
## 3.2 Testando o Registro Privado
1. **Taguear uma Imagem**:

bash
```
docker tag nginx:latest localhost:5000/nginx
```
2. **Enviar a Imagem para o Registro**:

bash
```
docker push localhost:5000/nginx
```
3. **Baixar a Imagem do Registro**:

bash
```
docker pull localhost:5000/nginx
```
## 3.3 Persist√™ncia de Dados no Registro
Por padr√£o, os dados (imagens) armazenados no registro s√£o tempor√°rios. Para persistir os dados, monte um volume:

bash
```
docker run -d -p 5000:5000 --name registry -v /meus-dados/registry:/var/lib/registry registry:2
```
## 3.4 Configurando Autentica√ß√£o no Registro
Para proteger seu registro com autentica√ß√£o, voc√™ pode usar um proxy como o **Nginx** para gerenciar credenciais.

1. **Gerar Arquivo de Senhas**:

bash
```
htpasswd -Bc /caminho/auth/htpasswd usuario
```
2. **Configurar o Proxy no Nginx**: Configure o Nginx para autenticar usu√°rios antes de acessar o registro.

# 4. Registries Populares
## 4.1 Docker Hub
- Servi√ßo p√∫blico padr√£o do Docker.
- Acesse aqui.
## 4.2 Amazon Elastic Container Registry (ECR)
- Servi√ßo da AWS para gerenciar imagens em nuvem.
- Integrado com outros servi√ßos da AWS.
### Login no ECR:

bash
```
aws ecr get-login-password --region <regiao> | docker login --username AWS --password-stdin <url-do-repositorio>
```
## 4.3 GitHub Container Registry
- Gerencie imagens Docker em reposit√≥rios do GitHub.
- Requer autentica√ß√£o com um token do GitHub.
### Login no Registro do GitHub:

bash
```
echo <TOKEN> | docker login ghcr.io -u <USUARIO> --password-stdin
```
## 4.4 Google Container Registry (GCR)
- Registro de cont√™ineres do Google Cloud.
- Integrado ao GKE (Google Kubernetes Engine).
### Login no GCR:

bash
```
gcloud auth configure-docker
```
# 5. Compara√ß√£o: Docker Hub vs Registro Privado
| Aspecto           | Docker Hub                              | Registro Privado                         |
| ----------------- | --------------------------------------- | ---------------------------------------- |
| Facilidade de Uso | Configura√ß√£o pronta para uso.           | Requer instala√ß√£o e configura√ß√£o.        |
| Custo             | Gratuito (com limites).                 | Depende da infraestrutura.               |
| Controle          | Gerenciado por terceiros.               | Total controle sobre o ambiente.         |
| Seguran√ßa         | Sujeito √†s pol√≠ticas do Docker Hub.     | Configur√°vel de acordo com sua pol√≠tica. |
| Performance       | Vari√°vel, dependendo do tr√°fego global. | Melhor para redes locais ou dedicadas.   |

# 6. Dicas e Boas Pr√°ticas
1. **Use Tags Descritivas**:
- Nomeie imagens com tags significativas:

bash
```
minha-aplicacao:versao1.0
```
2. **Limpe Imagens N√£o Utilizadas**:
- Regularmente remova imagens desnecess√°rias para economizar espa√ßo.

3. **Implemente Seguran√ßa**:
- Use autentica√ß√£o em registros privados.
- Digitalize imagens com ferramentas como `trivy` ou `docker scan`.

4. **Versione Suas Imagens**:
- Sempre utilize tags espec√≠ficas (como `1.0`) em vez de gen√©ricas (`latest`).

5. **Automatize Builds e Deploys**:
- Integre o registro em pipelines CI/CD para automa√ß√£o.

# 7. Exemplo Completo de Configura√ß√£o
## Dockerfile
dockerfile
```
FROM nginx:alpine
COPY index.html /usr/share/nginx/html
```
## Passos
1. **Construir a Imagem**:

bash
```
docker build -t localhost:5000/meu-site:1.0 .
```
2. **Enviar para o Registro Privado**:

bash
```
docker push localhost:5000/meu-site:1.0
```
3. **Baixar e Executar a Imagem**:

bash
```
docker pull localhost:5000/meu-site:1.0
docker run -d -p 8080:80 localhost:5000/meu-site:1.0
```
4. **Acessar o Servi√ßo**:
- Abra http://localhost:8080 no navegador.

# 8. Conclus√£o
O Docker Registry √© uma pe√ßa central no ecossistema do Docker, seja usando servi√ßos p√∫blicos como o Docker Hub ou configurando um registro privado para atender √†s necessidades de seguran√ßa e performance.

## Resumo:
- **Docker Hub**: Simples e ideal para imagens p√∫blicas.
- **Registros Privados**: Maior controle e personaliza√ß√£o.
- **Automa√ß√£o**: Integre registries em pipelines para facilitar o desenvolvimento e deploy.

Se precisar de ajuda para configurar um registro privado ou usar registries populares, √© s√≥ chamar! üöÄüòä